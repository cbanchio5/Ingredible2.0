<div class="message-container-fluid bg-color-primary5">
  <!-- Community header -->
  <div class="blog--header" style="background-image: linear-gradient(rgba(18,149,117,0.1), rgba(250,250,250,0.3)), url('<%= cl_image_path @community.photo.key, height: 500, crop: :fill %>')">
    <div class="header--text">
      <h1 class="text-black title--header"><%= @community.name %></h1>
    </div>
  </div>

  <div class="container">
    <h3 class="text-black mt-3">Comments</h3>

    <div class="comment--section bg-color-primary5">
      <% if @messages.any? %>
        <%= render partial: "show_welcome", locals: { message: @messages.first } %>
        <% @messages.drop(1).each do |message| %>
          <%= render partial: "show", locals: { message: message } %>
        <% end %>
      <% else %>
        <p class="text-muted">No comments yet. Be the first to comment!</p>
      <% end %>
    </div>
  </div>

  <%# Message form or join button %>
  <div class="container mt-4">
    <% if @membership || current_user.admin %>
      <%= form_with model: [@community, @message], local: false, html: { class: "message--form p-5 mt-2 d-inline" } do |f| %>
        <div class="d-flex flex-row align-items-center justify-content-start">
          <%= f.text_area :content, placeholder: "Insert your message", class: "gray-border-rounded mr-4 p-2 adjust--with flex-grow-1" %>
          <%= f.submit class: "btn btn-primary mx-2 p-2 mt-3" do %>
            <i class="fas fa-share"></i>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <div class="w-50 d-flex mx-5">
        <%= button_to "Join", community_memberships_path(@community), method: :post, remote: true, class:"btn btn-primary m-3" %>
      </div>
    <% end %>
  </div>
</div>